!function(I){var n={};function g(c){if(n[c])return n[c].exports;var C=n[c]={i:c,l:!1,exports:{}};return I[c].call(C.exports,C,C.exports,g),C.l=!0,C.exports}g.m=I,g.c=n,g.d=function(I,n,c){g.o(I,n)||Object.defineProperty(I,n,{enumerable:!0,get:c})},g.r=function(I){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(I,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(I,"__esModule",{value:!0})},g.t=function(I,n){if(1&n&&(I=g(I)),8&n)return I;if(4&n&&"object"==typeof I&&I&&I.__esModule)return I;var c=Object.create(null);if(g.r(c),Object.defineProperty(c,"default",{enumerable:!0,value:I}),2&n&&"string"!=typeof I)for(var C in I)g.d(c,C,function(n){return I[n]}.bind(null,C));return c},g.n=function(I){var n=I&&I.__esModule?function(){return I.default}:function(){return I};return g.d(n,"a",n),n},g.o=function(I,n){return Object.prototype.hasOwnProperty.call(I,n)},g.p="",g(g.s=8)}({8:function(module,exports){eval('//TODO  check and be sure the user picks a username from the dropdown menu\n//TODO  implement the placeholder for the select tags in the anotation table\n//TODO  find a way for the user to give a set of values for the annotations and make it obvious that it works this way\n\n// Add avatar based on project\'s name\njdenticon.update($("svg")[0],md5(projectShortname));\n\n// WS Autocompletion\nvar cb, label;\nvar host = "ws://" + window.location.hostname + ":8080/";\nif (window.WebSocket) {\n    ws=new WebSocket(host);\n} else if (window.MozWebSocket) {\n    ws=new MozWebSocket(host);\n}\nws.onopen = function(msg) {\n    ws.send(JSON.stringify({"type":"autocompleteClient"}));\n}\nws.onmessage = function(message) {\n    message = JSON.parse(message.data);\n    if (message.type === "userNameQuery") {\n        var arr;\n        if(label=="nickname")\n            arr=$.map(message.metadata,function(o){return {label:o.nickname,nickname:o.nickname,name:o.name}});\n        if(label=="name")\n            arr=$.map(message.metadata,function(o){return {label:o.name,nickname:o.nickname,name:o.name}});\n        cb(arr);\n    }\n}\n\nvar projectInfoProxy={};\n\nbind2(projectInfoProxy,projectInfo,"url","#projDescription #url");\nbind2(projectInfoProxy,projectInfo,"description","#projDescription #description");\nbind2(projectInfoProxy,projectInfo,"name","#projectName");\n\nvar accParam = {\n    table: $("table#access"),\n    info_proxy: projectInfoProxy,\n    info: projectInfo,\n    trTemplate: $.map([\n        "<tr>",\n        "    <td contentEditable=true class=\'noEmpty autocomplete\' data-autocomplete=\'user.nickname\'></td>",\n        "    <td contentEditable=true class=\'noEmpty autocomplete\' data-autocomplete=\'user.name\'></td>",\n        "    <td>",\n        "        <div class=\'access\' data-level=2>",\n        "            <span class=\'view\' title=\'view collaborators\'></span>",\n        "            <span class=\'edit\' title=\'edit collaborators\'></span>",\n        "            <span class=\'add\' title=\'add collaborators\'></span>",\n        "            <span class=\'remove\' title=\'remove collaborators\'></span>",\n        "        </div>",\n        "    </td>",\n        "    <td>",\n        "        <div class=\'access\' data-level=2>",\n        "            <span class=\'view\' title=\'view annotations\'></span>",\n        "            <span class=\'edit\' title=\'edit annotations\'></span>",\n        "            <span class=\'add\' title=\'add annotations\'></span>",\n        "            <span class=\'remove\' title=\'remove annotations\'></span>",\n        "        </div>",\n        "    </td>",\n        "    <td>",\n        "        <div class=\'access\' data-level=2>",\n        "            <span class=\'view\' title=\'view MRI files\'></span>",\n        "            <span class=\'edit\' title=\'edit MRI files\' ></span>",\n        "            <span class=\'add\' title=\'add MRI files\'></span>",\n        "            <span class=\'remove\' title=\'remove MRI files\'></span>",\n        "        </div>",\n        "    </td>",\n        "</tr>"],function(o){return o}).join(""),\n    objTemplate: [\n        {\ttypeOfBinding:2,\n            path:"collaborators.list.#.username" // nickname\n        },\n        {\ttypeOfBinding:2,\n            path:"collaborators.list.#.name" // full name\n        },\n        {\ttypeOfBinding:2,\n            path:"collaborators.list.#.access.collaborators",\n            format: function(e,d){$(e).find(".access").attr(\'data-level\',["none","view","edit","add","remove"].indexOf(d))},\n            parse: function(e){var level=$(e).find(".access").attr("data-level");return ["none","view","edit","add","remove"][level]}\n        },\n        {\ttypeOfBinding:2,\n            path:"collaborators.list.#.access.annotations",\n            format: function(e,d){$(e).find(".access").attr(\'data-level\',["none","view","edit","add","remove"].indexOf(d))},\n            parse: function(e){var level=$(e).find(".access").attr("data-level");return ["none","view","edit","add","remove"][level]}\n        },\n        {\ttypeOfBinding:2,\n            path:"collaborators.list.#.access.files",\n            format: function(e,d){$(e).find(".access").attr(\'data-level\',["none","view","edit","add","remove"].indexOf(d))},\n            parse: function(e){var level=$(e).find(".access").attr("data-level");return ["none","view","edit","add","remove"][level]}\n        }\n    ]\n};\nfor(var i=0;i<projectInfo.collaborators.list.length;i++) {\n    BrainBox.appendAnnotationTableRow(i,accParam);\n}\n\nvar annParam;\nBrainBox.loadLabelsets()\n.then(function () {\n    annParam = {\n        table: $("table#annotations"),\n        info_proxy: projectInfoProxy,\n        info: projectInfo,\n        trTemplate: $.map([\n            "<tr>",\n            " <td contentEditable=true class=\'noEmpty\'></td>",\n            " <td><select class=\'mui-select\'>",BrainBox.annotationType.map(function(o){return "<option>"+o+"</option>"}),"</select></td>",\t// append annotation types\n            " <td contentEditable=true class=\'noEmpty\'>",\n            "  <select class=\'mui-select\'>",BrainBox.labelSets.map(function(o){return "<option>"+o.name+"</option>"}),"</select>",\n            " </td>",\t// append label sets\n            " <td>","<div class=\'display\' data-check=0></div>","</td>",\n//            " <td>","<div class=\'display\' data-check=0>","<span class=\'check\' title=\'display\'></span>","</div>","</td>",\n            "</tr>"],function(o){return o}).join(""),\n        objTemplate: [\n            {\ttypeOfBinding:2,\n                path:"annotations.list.#.name"\n            },\n            {\ttypeOfBinding:2,\n                path:"annotations.list.#.type",\n                format: function(e,d){$(e).find("select").prop(\'selectedIndex\',BrainBox.annotationType.indexOf(d))},\n                parse: function(e){return $(e).find("select").val()}\n            },\n            {\ttypeOfBinding:2,\n                path:"annotations.list.#.values",\n                format: function (e,d) {\n                    var t=$(e).closest("tr").find("td:eq(1) select").prop(\'selectedIndex\');\n                    if(t==0)\n                        $(e).find("select").prop(\'selectedIndex\',BrainBox.labelSets.map(function(o){return o.source}).indexOf(d));\n                    else\n                        $(e).html(d)\n                },\n                parse: function(e) {\n                    var t=$(e).closest("tr").find("td:eq(1) select").prop(\'selectedIndex\');\n                    if(t==0)\n                        return BrainBox.labelSets[$(e).find("select").prop(\'selectedIndex\')].source;\n                    else\n                        return $(e).text();\n                }\n            },\n            {\ttypeOfBinding:2,\n                path:"annotations.list.#.display",\n                format: function(e,d){$(e).find(".display").attr("data-check",(d==\'true\')?"1":"0")},\n                parse: function(e){return ($(e).find(".display").attr("data-check")=="1"?\'true\':\'false\')}\n            }\n        ]\n    };\n    var i;\n    for(i=0;i<projectInfo.annotations.list.length;i++) {\n        BrainBox.appendAnnotationTableRow(i,annParam);\n    }\n    \n    // Each project requires at least 1 volume-type annotation\n    // Add a default one if there is none.\n    var volAnnFound = false;\n    for(i=0;i<projectInfo.annotations.list.length;i++) {\n        if(projectInfo.annotations.list[i].type == "volume") {\n            volAnnFound = true;\n            break;\n        }\n    }\n    if(volAnnFound == false) {\n        addAnnotation(annParam);\n    }\n});\n\nvar filesParam = {\n    table: $("table#MRIFiles"),\n    info_proxy: projectInfoProxy,\n    info: projectInfo,\n    trTemplate: $.map([\n        "<tr>",\n        "    <td contentEditable=true class=\'noEmpty\'></td>",\n        "    <td contentEditable=true class=\'noEmpty\'></td>",\n        "</tr>"],function(o){return o}).join(""),\n    objTemplate: [\n        {\ttypeOfBinding:2,\n            path:"files.list.#.source"\n        },\n        {\ttypeOfBinding:2,\n            path:"files.list.#.name"\n        }\n    ]\n};\n\nvar cursorFiles = 0;\nqueryFiles();\n\nfunction queryFiles() {\n    $.get("/project/json/"+projectInfo.shortname+"/files", {start:cursorFiles,length:100,name:true})\n    .then(function(list) {\n        if(list.length) {\n            appendFiles(list);\n            cursorFiles += 100;\n            queryFiles();\n        }\n    });\n}\nfunction appendFiles(list) {\n    projectInfo.files.list.push.apply(projectInfo.files.list, list);\n    for(var i=0;i<list.length;i++) {\n        BrainBox.appendAnnotationTableRow(cursorFiles + i, filesParam);\n    }\n    $("#numFiles").text(projectInfo.files.list.length);\n}\n\n\n$("#projDescription #numFiles").text(projectInfo.files.list.length);\n$("#projDescription #numAnnotations").text(projectInfo.annotations.list.length);\n$("#projDescription #numCollaborators").text(projectInfo.collaborators.list.length);\n\n// for the access widget\n$("body").on(\'click\',".view",function(e){onAccessClicked(e,0)});\n$("body").on(\'click\',".edit",function(e){onAccessClicked(e,1)});\n$("body").on(\'click\',".add",function(e){onAccessClicked(e,2)});\n$("body").on(\'click\',".remove",function(e){onAccessClicked(e,3)});\n$("#access tbody").on(\'click\',\'tr\',function(e){selectRow(e);disableDeleteOnAnyoneUser(e);});\n\n$("#annotations tbody").on(\'click\',\'tr\',selectRow);\n$("#MRIFiles tbody").on(\'click\',\'tr\',selectRow);\n\n$("#saveChanges").click(saveChanges);\n$("#deleteProject").click(deleteProject);\n$("#goToProject").click(function goToProject(){location.pathname=`/project/${projectShortname}`});\n\n$("body").on(\'click\',".display",function(e){onCheckClicked(e)}); // for the display option\n\n$(document).on(\'click\', "#addCollaborator", function(){addCollaborator(accParam)});\n$(document).on(\'click\', "#removeCollaborator", function(){removeCollaborator(accParam)});\n$("table#access tr").removeClass("selected");\n$("table#access tbody tr").eq(0).addClass("selected");\n$("table#access tbody tr:eq(0) td").removeAttr("contentEditable");\n$("#removeCollaborator").addClass("disabled");\n\n$(document).on(\'click\', "#addAnnotation", function(){addAnnotation(annParam)});\n$(document).on(\'click\', "#removeAnnotation", function(){removeAnnotation(annParam)});\n$("table#annotations tr").removeClass("selected");\n$("table#annotations tbody tr").eq(0).addClass("selected");\n\n$(document).on(\'click\', "#addFile", function(){addFile(filesParam)});\n$(document).on(\'click\', "#removeFile", function(){removeFile(filesParam)});\n$(document).on(\'click\', "#importFiles", function(){importFiles()});\n$("table#MRIFiles tr").removeClass("selected");\n$("table#MRIFiles tbody tr").eq(0).addClass("selected");\n\n$("#importFilesDialogOk").click(importFilesDialog);\n$("#importFilesDialogCancel").click(function() {\n    $("#importFilesDialog").hide();\n});\n$("#addProject").click(function(){location="/project/new"});\n\n// listen to type of annotation changes\n$("#annotations tbody").on(\'change\', "td:nth-child(2) select", function(e) {\n    var irow=$(e.target).closest("tr").index();\n    var t=$(e.target).prop(\'selectedIndex\');\n    if(t==0) {\n        var arr= [\n            "<select>",\n            BrainBox.labelSets.map(function(o){return "<option>"+o.name+"</option>"}),\n            "</select>"\n        ];\n        var str=$.map(arr,function(o){return o}).join("");\n        $("#annotations tbody  tr:eq("+irow+") td:eq(2)").html(str);\n    } else {\n        $("#annotations tbody  tr:eq("+irow+") td:eq(2)").html("");\n    }\n});\n\n/**\n * @function onAccessClicked\n * @desc Handles click on one of the 5 access levels: 0=none, 1=view, 2=edit, 3=add, 4=remove\n * @param {Event} e Event triggered by the click\n * @param {int} l Base level of the access icon clicked\n */\nfunction onAccessClicked( e, l ) {\n    // access level \n    var al = $( e.target ).closest( "div" ).attr( "data-level" );\n    $( e.target ).closest( "div" ).attr( "data-level",l+( al != (l+1) ) );\n}\n\n/** \n * @function onCheckClicked\n * @desc Handles click on \'display\' option for annotations in the project settings; 0=do not display; 1=display\n * @param {Event} e Event triggered by click\n */\nfunction onCheckClicked( e, l ) {\n    // checkbox toggle for \'display\' option\n    var checkbox = ($( e.target ).closest("div").attr( "data-check" ) === "1");\n    if( checkbox == false ) {\n        $( e.target ).closest("div").attr( "data-check", "1" );\n    }\n    else {\n        $( e.target ).closest("div").attr( "data-check", "0" );\n    }\n}\n\nfunction selectRow(e) {\n    $(e.currentTarget).closest("tbody").find("tr").each(function(index, tag) {\n        $(tag).removeClass("selected");\n    })\n    $(e.currentTarget).addClass("selected");\n}\nfunction disableDeleteOnAnyoneUser(e) {\n    var curTable = $(e.currentTarget).closest("table").attr("id");\n\n    // check if the selected row belongs to the #access table\n    if(curTable === "access") {\n        // check if the selected user is \'anyone\'\n        var rowIndex = $(e.currentTarget).closest("tbody").find("tr.selected").index();\n        if(projectInfo.collaborators.list[rowIndex].userID === \'anyone\') {\n            // if yes, disable the \'remove\' button\n            $("#removeCollaborator").addClass(\'disabled\');\n        } else {\n            $("#removeCollaborator").removeClass(\'disabled\');\n        }\n    }\n}\n\nfunction importFilesDialog() {\n    var sum=0;\n    $("#importFilesDialog tbody tr").each(function(i,o) {\n        var url=$(o).find("td:eq(0)").text();\n        var name=$(o).find("td:eq(1)").text();\n        var i,found;\n        \n        if(url.length<10)\n            return;\n        \n        // update the projectInfo object by calling the proxy\'s getters\n        JSON.stringify(projectInfoProxy);\n        \n        // look if the MRI file is not already in the list\n        found=false;\n        for(i in projectInfo.files.list) {\n            if(projectInfo.files.list[i].source==url) {\n                if(projectInfo.files.list[i].name=="")\n                    projectInfoProxy["files.list."+i+".name"]=name;\n                found=true;\n                break;\n            }\n        }\n        if(found===false) {\n            projectInfo.files.list.push({source:url, name:name});\n\n            // add and bind new table row\n            var i=projectInfo.files.list.length-1;\n            BrainBox.appendAnnotationTableRow(i,filesParam);\n\n            $("#projDescription #numFiles").text(projectInfo.files.list.length);\n            \n            sum++;\n        }\n    });\n    $("#importFilesDialog").hide();\n    console.log(sum,"files added");\n}\nfunction addCollaborator(param) {\n    projectInfo.collaborators.list.push({\n        userID: "",\n        access: {\n            collaborators:"view",\n            annotations:"view",\n            files:"view"\n        }\n    });\n\n    // add and bind new table row\n    var i=projectInfo.collaborators.list.length-1;\n    BrainBox.appendAnnotationTableRow(i,param);\n    \n    /** @todo Fix: This is adding the autocompletion listener again and again to previously\n     *        added collaborators\n     */\n    // configure autocompletion\n    $(".autocomplete").autocomplete({\n        minLength: 0,\n        source: function(req,res) {\n            var key = $(this.element).attr(\'data-autocomplete\');\n            switch(key) {\n                case "user.nickname":\n                    ws.send(JSON.stringify({"type":"userNameQuery", "metadata":{"nickname":req.term}}));\n                    label="nickname";\n                    break;\n                case "user.name":\n                    ws.send(JSON.stringify({"type":"userNameQuery", "metadata":{"name":req.term}}));\n                    label="name";\n                    break;\n            }\n            cb=res;\n        },\n        select:function(e,ui) {\n            var irow=$(e.target).closest(\'tr\').index();\n            projectInfoProxy["collaborators.list."+irow+".name"]=ui.item.name;\n            projectInfoProxy["collaborators.list."+irow+".userID"]=ui.item.nickname;\n\n            // add user to access objects\n            projectInfo.collaborators.list[irow].userID=ui.item.nickname;\n        }\n    });\n\n    // update number of collaborators counter\n    $("#projDescription #numCollaborators").text(projectInfo.collaborators.list.length);\n}\nfunction removeCollaborator(param) {\n    // remove row from table\n    var index=$(param.table).find("tbody .selected").index();\n    $(param.table).find(\'tbody tr:eq(\'+index+\')\').remove();\n    \n    // remove binding\n    JSON.stringify(param.info_proxy); // update projectInfo from projectInfoProxy\n    var irow=projectInfo.collaborators.list.length-1;\n    for(var icol=0; icol<param.objTemplate.length; icol++) {\n        unbind2(param.info_proxy,param.objTemplate[icol].path.replace("#", irow));\n    }\n    \n    // remove row from BrainBox.info.mri.atlas\n    projectInfo.collaborators.list.splice(index,1);\n\n    $("#projDescription #numCollaborators").text(projectInfo.collaborators.list.length);\n}\nfunction addAnnotation(param) {\n    projectInfo.annotations.list.push({\n        type:"volume",\n        values:BrainBox.labelSets[0].source,\n        display:"true"\n    });\n\n    // add and bind new table row\n    var i=projectInfo.annotations.list.length-1;\n    BrainBox.appendAnnotationTableRow(i,param);\n\n    $("#projDescription #numAnnotations").text(projectInfo.annotations.list.length);\n}\nfunction removeAnnotation(param) {\n    // remove row from table\n    var index=$(param.table).find("tbody .selected").index();\n    $(param.table).find(\'tbody tr:eq(\'+index+\')\').remove();\n    \n    // remove binding\n    JSON.stringify(param.info_proxy); // update projectInfo from projectInfoProxy\n    var irow=projectInfo.annotations.list.length-1;\n    for(var icol=0; icol<param.objTemplate.length; icol++) {\n        unbind2(param.info_proxy,param.objTemplate[icol].path.replace("#", irow));\n    }\n    \n    // remove row from BrainBox.info.mri.atlas\n    projectInfo.annotations.list.splice(index,1);\n\n    $("#projDescription #numAnnotations").text(projectInfo.annotations.list.length);\n}\nfunction addFile(param) {\n    projectInfo.files.list.push({});\n\n    // add and bind new table row\n    var i=projectInfo.files.list.length-1;\n    BrainBox.appendAnnotationTableRow(i,param);\n\n    $("#projDescription #numFiles").text(projectInfo.files.list.length);\n}\nfunction removeFile(param) {\n    // remove row from table\n    var index=$(param.table).find("tbody .selected").index();\n    $(param.table).find(\'tbody tr:eq(\'+index+\')\').remove();\n    \n    // remove binding\n    JSON.stringify(param.info_proxy); // update projectInfo from projectInfoProxy\n    var irow=projectInfo.files.list.length-1;\n    for(var icol=0; icol<param.objTemplate.length; icol++) {\n        unbind2(param.info_proxy,param.objTemplate[icol].path.replace("#", irow));\n    }\n    \n    // remove row from BrainBox.info.mri.atlas\n    projectInfo.files.list.splice(index,1);\n\n    $("#projDescription #numFiles").text(projectInfo.files.list.length);\n    \n    // select the closest remaining column\n    $(param.table).find(\'tbody tr:eq(\'+(Math.min(index,projectInfo.files.list.length-1))+\')\').addClass(\'selected\');\n}\nfunction importFiles() {\n    // var input=document.getElementById("i-open-mesh");\n    console.log("importing files...");\n    $("body").append("<input id=\'importFilesInput\' style=\'display:none\'>");\n    var input=$("#importFilesInput")[0];\n    console.log(input);\n    input.type="file";\n    input.onchange=function(e){\n        var file=this.files[0];\n        var reader = new FileReader();\n        reader.onload = function(e) {\n            $("#importFilesInput").remove();\n            $("#importFilesDialog").show();\n            var result=e.target.result;\n            var lines=result.split("\\n");\n            var html=[];           \n            for(i in lines) {\n                cols=lines[i].split(/[ ]*,[ ]*/);\n                html.push("<tr><td contentEditable=\'true\'>"+cols[0]+"</td><td>"+cols[1]+"</td></tr>");\n            }\n            $("#importFilesDialog tbody").append(html.join("\\n"));\n        }\n        reader.readAsText(file);\n    }\n    input.click();\n}\nfunction saveChanges() {\n    // update projectInfo from projectInfoProxy\n    JSON.stringify(projectInfoProxy);\n\n    $.post("/project/json/"+projectInfo.shortname, {\n            data:JSON.stringify(projectInfo)\n    }).done(function(a, b) {\n        if(a.success) {\n            $("#saveFeedback").text("Successfully saved");\n            setTimeout(function() {\n                $("#saveFeedback").text("");\n            },2000);\n        } else {\n            $("#saveFeedback").text("Unable to save. Please try again later");\n            setTimeout(function() {\n                $("#saveFeedback").text("");\n            },3000);\n        }\n    }).catch(function(err) {\n        $("#saveFeedback").text("Unable to save. Please try again later ("+JSON.stringify(err.responseJSON.message)+")");\n        setTimeout(function() {\n            $("#saveFeedback").text("");\n        },3000);\n        console.log(err);\n    });\n}\nfunction deleteProject() {\n    // update projectInfo from projectInfoProxy\n    JSON.stringify(projectInfoProxy);\n\n    var res = confirm(\n        "Are you sure you want to delete project "\n        + projectInfo.shortname+"? "\n        + "This operation cannot be undone."\n    );\n    \n    if (res !== true) {\n        return;\n    }\n    \n    $.ajax({\n        url: "/project/json/"+projectInfo.shortname,\n        method: "delete",\n        data:JSON.stringify(projectInfo)\n    }).done(function(response) {\n        if(response.success) {\n            $("#saveFeedback").text("Successfully deleted");\n            setTimeout(function() {\n                $("#saveFeedback").text("");\n                location="/";\n            },2000);\n        } else {\n            $("#saveFeedback").text("Unable to delete ("+response.message+")");\n            setTimeout(function() {\n                $("#saveFeedback").text("");\n            },3000);\n        }\n        console.log(response.message);\n    }).catch(function(err) {\n        $("#saveFeedback").text("Unable to delete. Please try again later ("+JSON.stringify(err.responseJSON.error.error)+")");\n        setTimeout(function() {\n            $("#saveFeedback").text("");\n        },3000);\n        console.log(err);\n    });\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi92aWV3L2JyYWluYm94L3NyYy9wYWdlcy9wcm9qZWN0LXNldHRpbmdzLXBhZ2UuanM/ODgwNyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qiw0QkFBNEI7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbURBQW1ELFFBQVEsa0RBQWtEO0FBQzdHO0FBQ0EsbURBQW1ELFFBQVEsOENBQThDO0FBQ3pHO0FBQ0E7QUFDQTs7QUFFQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZCQUE2QixTQUFTO0FBQ3RDO0FBQ0EsU0FBUztBQUNUO0FBQ0EsU0FBUztBQUNULFNBQVM7QUFDVDtBQUNBLFNBQVM7QUFDVCxTQUFTO0FBQ1Q7QUFDQSxrQ0FBa0MseUZBQXlGO0FBQzNILCtCQUErQixrREFBa0Q7QUFDakYsU0FBUztBQUNULFNBQVM7QUFDVDtBQUNBLGtDQUFrQyx5RkFBeUY7QUFDM0gsK0JBQStCLGtEQUFrRDtBQUNqRixTQUFTO0FBQ1QsU0FBUztBQUNUO0FBQ0Esa0NBQWtDLHlGQUF5RjtBQUMzSCwrQkFBK0Isa0RBQWtEO0FBQ2pGO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0NBQXdDO0FBQ3BEO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1RkFBdUYsZ0NBQWdDO0FBQ3ZIO0FBQ0EsK0VBQStFLHFDQUFxQztBQUNwSDtB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Q0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxLQUFLO0FBQ0wiLCJmaWxlIjoiOC5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8vVE9ETyAgY2hlY2sgYW5kIGJlIHN1cmUgdGhlIHVzZXIgcGlja3MgYSB1c2VybmFtZSBmcm9tIHRoZSBkcm9wZG93biBtZW51XG4vL1RPRE8gIGltcGxlbWVudCB0aGUgcGxhY2Vob2xkZXIgZm9yIHRoZSBzZWxlY3QgdGFncyBpbiB0aGUgYW5vdGF0aW9uIHRhYmxlXG4vL1RPRE8gIGZpbmQgYSB3YXkgZm9yIHRoZSB1c2VyIHRvIGdpdmUgYSBzZXQgb2YgdmFsdWVzIGZvciB0aGUgYW5ub3RhdGlvbnMgYW5kIG1ha2UgaXQgb2J2aW91cyB0aGF0IGl0IHdvcmtzIHRoaXMgd2F5XG5cbi8vIEFkZCBhdmF0YXIgYmFzZWQgb24gcHJvamVjdCdzIG5hbWVcbmpkZW50aWNvbi51cGRhdGUoJChcInN2Z1wiKVswXSxtZDUocHJvamVjdFNob3J0bmFtZSkpO1xuXG4vLyBXUyBBdXRvY29tcGxldGlvblxudmFyIGNiLCBsYWJlbDtcbnZhciBob3N0ID0gXCJ3czovL1wiICsgd2luZG93LmxvY2F0aW9uLmhvc3RuYW1lICsgXCI6ODA4MC9cIjtcbmlmICh3aW5kb3cuV2ViU29ja2V0KSB7XG4gICAgd3M9bmV3IFdlYlNvY2tldChob3N0KTtcbn0gZWxzZSBpZiAod2luZG93Lk1veldlYlNvY2tldCkge1xuICAgIHdzPW5ldyBNb3pXZWJTb2NrZXQoaG9zdCk7XG59XG53cy5vbm9wZW4gPSBmdW5jdGlvbihtc2cpIHtcbiAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcInR5cGVcIjpcImF1dG9jb21wbGV0ZUNsaWVudFwifSkpO1xufVxud3Mub25tZXNzYWdlID0gZnVuY3Rpb24obWVzc2FnZSkge1xuICAgIG1lc3NhZ2UgPSBKU09OLnBhcnNlKG1lc3NhZ2UuZGF0YSk7XG4gICAgaWYgKG1lc3NhZ2UudHlwZSA9PT0gXCJ1c2VyTmFtZVF1ZXJ5XCIpIHtcbiAgICAgICAgdmFyIGFycjtcbiAgICAgICAgaWYobGFiZWw9PVwibmlja25hbWVcIilcbiAgICAgICAgICAgIGFycj0kLm1hcChtZXNzYWdlLm1ldGFkYXRhLGZ1bmN0aW9uKG8pe3JldHVybiB7bGFiZWw6by5uaWNrbmFtZSxuaWNrbmFtZTpvLm5pY2tuYW1lLG5hbWU6by5uYW1lfX0pO1xuICAgICAgICBpZihsYWJlbD09XCJuYW1lXCIpXG4gICAgICAgICAgICBhcnI9JC5tYXAobWVzc2FnZS5tZXRhZGF0YSxmdW5jdGlvbihvKXtyZXR1cm4ge2xhYmVsOm8ubmFtZSxuaWNrbmFtZTpvLm5pY2tuYW1lLG5hbWU6by5uYW1lfX0pO1xuICAgICAgICBjYihhcnIpO1xuICAgIH1cbn1cblxudmFyIHByb2plY3RJbmZvUHJveHk9e307XG5cbmJpbmQyKHByb2plY3RJbmZvUHJveHkscHJvamVjdEluZm8sXCJ1cmxcIixcIiNwcm9qRGVzY3JpcHRpb24gI3VybFwiKTtcbmJpbmQyKHByb2plY3RJbmZvUHJveHkscHJvamVjdEluZm8sXCJkZXNjcmlwdGlvblwiLFwiI3Byb2pEZXNjcmlwdGlvbiAjZGVzY3JpcHRpb25cIik7XG5iaW5kMihwcm9qZWN0SW5mb1Byb3h5LHByb2plY3RJbmZvLFwibmFtZVwiLFwiI3Byb2plY3ROYW1lXCIpO1xuXG52YXIgYWNjUGFyYW0gPSB7XG4gICAgdGFibGU6ICQoXCJ0YWJsZSNhY2Nlc3NcIiksXG4gICAgaW5mb19wcm94eTogcHJvamVjdEluZm9Qcm94eSxcbiAgICBpbmZvOiBwcm9qZWN0SW5mbyxcbiAgICB0clRlbXBsYXRlOiAkLm1hcChbXG4gICAgICAgIFwiPHRyPlwiLFxuICAgICAgICBcIiAgICA8dGQgY29udGVudEVkaXRhYmxlPXRydWUgY2xhc3M9J25vRW1wdHkgYXV0b2NvbXBsZXRlJyBkYXRhLWF1dG9jb21wbGV0ZT0ndXNlci5uaWNrbmFtZSc+PC90ZD5cIixcbiAgICAgICAgXCIgICAgPHRkIGNvbnRlbnRFZGl0YWJsZT10cnVlIGNsYXNzPSdub0VtcHR5IGF1dG9jb21wbGV0ZScgZGF0YS1hdXRvY29tcGxldGU9J3VzZXIubmFtZSc+PC90ZD5cIixcbiAgICAgICAgXCIgICAgPHRkPlwiLFxuICAgICAgICBcIiAgICAgICAgPGRpdiBjbGFzcz0nYWNjZXNzJyBkYXRhLWxldmVsPTI+XCIsXG4gICAgICAgIFwiICAgICAgICAgICAgPHNwYW4gY2xhc3M9J3ZpZXcnIHRpdGxlPSd2aWV3IGNvbGxhYm9yYXRvcnMnPjwvc3Bhbj5cIixcbiAgICAgICAgXCIgICAgICAgICAgICA8c3BhbiBjbGFzcz0nZWRpdCcgdGl0bGU9J2VkaXQgY29sbGFib3JhdG9ycyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdhZGQnIHRpdGxlPSdhZGQgY29sbGFib3JhdG9ycyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdyZW1vdmUnIHRpdGxlPSdyZW1vdmUgY29sbGFib3JhdG9ycyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgPC9kaXY+XCIsXG4gICAgICAgIFwiICAgIDwvdGQ+XCIsXG4gICAgICAgIFwiICAgIDx0ZD5cIixcbiAgICAgICAgXCIgICAgICAgIDxkaXYgY2xhc3M9J2FjY2VzcycgZGF0YS1sZXZlbD0yPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSd2aWV3JyB0aXRsZT0ndmlldyBhbm5vdGF0aW9ucyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdlZGl0JyB0aXRsZT0nZWRpdCBhbm5vdGF0aW9ucyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdhZGQnIHRpdGxlPSdhZGQgYW5ub3RhdGlvbnMnPjwvc3Bhbj5cIixcbiAgICAgICAgXCIgICAgICAgICAgICA8c3BhbiBjbGFzcz0ncmVtb3ZlJyB0aXRsZT0ncmVtb3ZlIGFubm90YXRpb25zJz48L3NwYW4+XCIsXG4gICAgICAgIFwiICAgICAgICA8L2Rpdj5cIixcbiAgICAgICAgXCIgICAgPC90ZD5cIixcbiAgICAgICAgXCIgICAgPHRkPlwiLFxuICAgICAgICBcIiAgICAgICAgPGRpdiBjbGFzcz0nYWNjZXNzJyBkYXRhLWxldmVsPTI+XCIsXG4gICAgICAgIFwiICAgICAgICAgICAgPHNwYW4gY2xhc3M9J3ZpZXcnIHRpdGxlPSd2aWV3IE1SSSBmaWxlcyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgICAgIDxzcGFuIGNsYXNzPSdlZGl0JyB0aXRsZT0nZWRpdCBNUkkgZmlsZXMnID48L3NwYW4+XCIsXG4gICAgICAgIFwiICAgICAgICAgICAgPHNwYW4gY2xhc3M9J2FkZCcgdGl0bGU9J2FkZCBNUkkgZmlsZXMnPjwvc3Bhbj5cIixcbiAgICAgICAgXCIgICAgICAgICAgICA8c3BhbiBjbGFzcz0ncmVtb3ZlJyB0aXRsZT0ncmVtb3ZlIE1SSSBmaWxlcyc+PC9zcGFuPlwiLFxuICAgICAgICBcIiAgICAgICAgPC9kaXY+XCIsXG4gICAgICAgIFwiICAgIDwvdGQ+XCIsXG4gICAgICAgIFwiPC90cj5cIl0sZnVuY3Rpb24obyl7cmV0dXJuIG99KS5qb2luKFwiXCIpLFxuICAgIG9ialRlbXBsYXRlOiBbXG4gICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgIHBhdGg6XCJjb2xsYWJvcmF0b3JzLmxpc3QuIy51c2VybmFtZVwiIC8vIG5pY2tuYW1lXG4gICAgICAgIH0sXG4gICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgIHBhdGg6XCJjb2xsYWJvcmF0b3JzLmxpc3QuIy5uYW1lXCIgLy8gZnVsbCBuYW1lXG4gICAgICAgIH0sXG4gICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgIHBhdGg6XCJjb2xsYWJvcmF0b3JzLmxpc3QuIy5hY2Nlc3MuY29sbGFib3JhdG9yc1wiLFxuICAgICAgICAgICAgZm9ybWF0OiBmdW5jdGlvbihlLGQpeyQoZSkuZmluZChcIi5hY2Nlc3NcIikuYXR0cignZGF0YS1sZXZlbCcsW1wibm9uZVwiLFwidmlld1wiLFwiZWRpdFwiLFwiYWRkXCIsXCJyZW1vdmVcIl0uaW5kZXhPZihkKSl9LFxuICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKGUpe3ZhciBsZXZlbD0kKGUpLmZpbmQoXCIuYWNjZXNzXCIpLmF0dHIoXCJkYXRhLWxldmVsXCIpO3JldHVybiBbXCJub25lXCIsXCJ2aWV3XCIsXCJlZGl0XCIsXCJhZGRcIixcInJlbW92ZVwiXVtsZXZlbF19XG4gICAgICAgIH0sXG4gICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgIHBhdGg6XCJjb2xsYWJvcmF0b3JzLmxpc3QuIy5hY2Nlc3MuYW5ub3RhdGlvbnNcIixcbiAgICAgICAgICAgIGZvcm1hdDogZnVuY3Rpb24oZSxkKXskKGUpLmZpbmQoXCIuYWNjZXNzXCIpLmF0dHIoJ2RhdGEtbGV2ZWwnLFtcIm5vbmVcIixcInZpZXdcIixcImVkaXRcIixcImFkZFwiLFwicmVtb3ZlXCJdLmluZGV4T2YoZCkpfSxcbiAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbihlKXt2YXIgbGV2ZWw9JChlKS5maW5kKFwiLmFjY2Vzc1wiKS5hdHRyKFwiZGF0YS1sZXZlbFwiKTtyZXR1cm4gW1wibm9uZVwiLFwidmlld1wiLFwiZWRpdFwiLFwiYWRkXCIsXCJyZW1vdmVcIl1bbGV2ZWxdfVxuICAgICAgICB9LFxuICAgICAgICB7XHR0eXBlT2ZCaW5kaW5nOjIsXG4gICAgICAgICAgICBwYXRoOlwiY29sbGFib3JhdG9ycy5saXN0LiMuYWNjZXNzLmZpbGVzXCIsXG4gICAgICAgICAgICBmb3JtYXQ6IGZ1bmN0aW9uKGUsZCl7JChlKS5maW5kKFwiLmFjY2Vzc1wiKS5hdHRyKCdkYXRhLWxldmVsJyxbXCJub25lXCIsXCJ2aWV3XCIsXCJlZGl0XCIsXCJhZGRcIixcInJlbW92ZVwiXS5pbmRleE9mKGQpKX0sXG4gICAgICAgICAgICBwYXJzZTogZnVuY3Rpb24oZSl7dmFyIGxldmVsPSQoZSkuZmluZChcIi5hY2Nlc3NcIikuYXR0cihcImRhdGEtbGV2ZWxcIik7cmV0dXJuIFtcIm5vbmVcIixcInZpZXdcIixcImVkaXRcIixcImFkZFwiLFwicmVtb3ZlXCJdW2xldmVsXX1cbiAgICAgICAgfVxuICAgIF1cbn07XG5mb3IodmFyIGk9MDtpPHByb2plY3RJbmZvLmNvbGxhYm9yYXRvcnMubGlzdC5sZW5ndGg7aSsrKSB7XG4gICAgQnJhaW5Cb3guYXBwZW5kQW5ub3RhdGlvblRhYmxlUm93KGksYWNjUGFyYW0pO1xufVxuXG52YXIgYW5uUGFyYW07XG5CcmFpbkJveC5sb2FkTGFiZWxzZXRzKClcbi50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICBhbm5QYXJhbSA9IHtcbiAgICAgICAgdGFibGU6ICQoXCJ0YWJsZSNhbm5vdGF0aW9uc1wiKSxcbiAgICAgICAgaW5mb19wcm94eTogcHJvamVjdEluZm9Qcm94eSxcbiAgICAgICAgaW5mbzogcHJvamVjdEluZm8sXG4gICAgICAgIHRyVGVtcGxhdGU6ICQubWFwKFtcbiAgICAgICAgICAgIFwiPHRyPlwiLFxuICAgICAgICAgICAgXCIgPHRkIGNvbnRlbnRFZGl0YWJsZT10cnVlIGNsYXNzPSdub0VtcHR5Jz48L3RkPlwiLFxuICAgICAgICAgICAgXCIgPHRkPjxzZWxlY3QgY2xhc3M9J211aS1zZWxlY3QnPlwiLEJyYWluQm94LmFubm90YXRpb25UeXBlLm1hcChmdW5jdGlvbihvKXtyZXR1cm4gXCI8b3B0aW9uPlwiK28rXCI8L29wdGlvbj5cIn0pLFwiPC9zZWxlY3Q+PC90ZD5cIixcdC8vIGFwcGVuZCBhbm5vdGF0aW9uIHR5cGVzXG4gICAgICAgICAgICBcIiA8dGQgY29udGVudEVkaXRhYmxlPXRydWUgY2xhc3M9J25vRW1wdHknPlwiLFxuICAgICAgICAgICAgXCIgIDxzZWxlY3QgY2xhc3M9J211aS1zZWxlY3QnPlwiLEJyYWluQm94LmxhYmVsU2V0cy5tYXAoZnVuY3Rpb24obyl7cmV0dXJuIFwiPG9wdGlvbj5cIitvLm5hbWUrXCI8L29wdGlvbj5cIn0pLFwiPC9zZWxlY3Q+XCIsXG4gICAgICAgICAgICBcIiA8L3RkPlwiLFx0Ly8gYXBwZW5kIGxhYmVsIHNldHNcbiAgICAgICAgICAgIFwiIDx0ZD5cIixcIjxkaXYgY2xhc3M9J2Rpc3BsYXknIGRhdGEtY2hlY2s9MD48L2Rpdj5cIixcIjwvdGQ+XCIsXG4vLyAgICAgICAgICAgIFwiIDx0ZD5cIixcIjxkaXYgY2xhc3M9J2Rpc3BsYXknIGRhdGEtY2hlY2s9MD5cIixcIjxzcGFuIGNsYXNzPSdjaGVjaycgdGl0bGU9J2Rpc3BsYXknPjwvc3Bhbj5cIixcIjwvZGl2PlwiLFwiPC90ZD5cIixcbiAgICAgICAgICAgIFwiPC90cj5cIl0sZnVuY3Rpb24obyl7cmV0dXJuIG99KS5qb2luKFwiXCIpLFxuICAgICAgICBvYmpUZW1wbGF0ZTogW1xuICAgICAgICAgICAge1x0dHlwZU9mQmluZGluZzoyLFxuICAgICAgICAgICAgICAgIHBhdGg6XCJhbm5vdGF0aW9ucy5saXN0LiMubmFtZVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1x0dHlwZU9mQmluZGluZzoyLFxuICAgICAgICAgICAgICAgIHBhdGg6XCJhbm5vdGF0aW9ucy5saXN0LiMudHlwZVwiLFxuICAgICAgICAgICAgICAgIGZvcm1hdDogZnVuY3Rpb24oZSxkKXskKGUpLmZpbmQoXCJzZWxlY3RcIikucHJvcCgnc2VsZWN0ZWRJbmRleCcsQnJhaW5Cb3guYW5ub3RhdGlvblR5cGUuaW5kZXhPZihkKSl9LFxuICAgICAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbihlKXtyZXR1cm4gJChlKS5maW5kKFwic2VsZWN0XCIpLnZhbCgpfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgICAgICBwYXRoOlwiYW5ub3RhdGlvbnMubGlzdC4jLnZhbHVlc1wiLFxuICAgICAgICAgICAgICAgIGZvcm1hdDogZnVuY3Rpb24gKGUsZCkge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdD0kKGUpLmNsb3Nlc3QoXCJ0clwiKS5maW5kKFwidGQ6ZXEoMSkgc2VsZWN0XCIpLnByb3AoJ3NlbGVjdGVkSW5kZXgnKTtcbiAgICAgICAgICAgICAgICAgICAgaWYodD09MClcbiAgICAgICAgICAgICAgICAgICAgICAgICQoZSkuZmluZChcInNlbGVjdFwiKS5wcm9wKCdzZWxlY3RlZEluZGV4JyxCcmFpbkJveC5sYWJlbFNldHMubWFwKGZ1bmN0aW9uKG8pe3JldHVybiBvLnNvdXJjZX0pLmluZGV4T2YoZCkpO1xuICAgICAgICAgICAgICAgICAgICBlbHNlXG4gICAgICAgICAgICAgICAgICAgICAgICAkKGUpLmh0bWwoZClcbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHBhcnNlOiBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhciB0PSQoZSkuY2xvc2VzdChcInRyXCIpLmZpbmQoXCJ0ZDplcSgxKSBzZWxlY3RcIikucHJvcCgnc2VsZWN0ZWRJbmRleCcpO1xuICAgICAgICAgICAgICAgICAgICBpZih0PT0wKVxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIEJyYWluQm94LmxhYmVsU2V0c1skKGUpLmZpbmQoXCJzZWxlY3RcIikucHJvcCgnc2VsZWN0ZWRJbmRleCcpXS5zb3VyY2U7XG4gICAgICAgICAgICAgICAgICAgIGVsc2VcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkKGUpLnRleHQoKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAge1x0dHlwZU9mQmluZGluZzoyLFxuICAgICAgICAgICAgICAgIHBhdGg6XCJhbm5vdGF0aW9ucy5saXN0LiMuZGlzcGxheVwiLFxuICAgICAgICAgICAgICAgIGZvcm1hdDogZnVuY3Rpb24oZSxkKXskKGUpLmZpbmQoXCIuZGlzcGxheVwiKS5hdHRyKFwiZGF0YS1jaGVja1wiLChkPT0ndHJ1ZScpP1wiMVwiOlwiMFwiKX0sXG4gICAgICAgICAgICAgICAgcGFyc2U6IGZ1bmN0aW9uKGUpe3JldHVybiAoJChlKS5maW5kKFwiLmRpc3BsYXlcIikuYXR0cihcImRhdGEtY2hlY2tcIik9PVwiMVwiPyd0cnVlJzonZmFsc2UnKX1cbiAgICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgIH07XG4gICAgdmFyIGk7XG4gICAgZm9yKGk9MDtpPHByb2plY3RJbmZvLmFubm90YXRpb25zLmxpc3QubGVuZ3RoO2krKykge1xuICAgICAgICBCcmFpbkJveC5hcHBlbmRBbm5vdGF0aW9uVGFibGVSb3coaSxhbm5QYXJhbSk7XG4gICAgfVxuICAgIFxuICAgIC8vIEVhY2ggcHJvamVjdCByZXF1aXJlcyBhdCBsZWFzdCAxIHZvbHVtZS10eXBlIGFubm90YXRpb25cbiAgICAvLyBBZGQgYSBkZWZhdWx0IG9uZSBpZiB0aGVyZSBpcyBub25lLlxuICAgIHZhciB2b2xBbm5Gb3VuZCA9IGZhbHNlO1xuICAgIGZvcihpPTA7aTxwcm9qZWN0SW5mby5hbm5vdGF0aW9ucy5saXN0Lmxlbmd0aDtpKyspIHtcbiAgICAgICAgaWYocHJvamVjdEluZm8uYW5ub3RhdGlvbnMubGlzdFtpXS50eXBlID09IFwidm9sdW1lXCIpIHtcbiAgICAgICAgICAgIHZvbEFubkZvdW5kID0gdHJ1ZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmKHZvbEFubkZvdW5kID09IGZhbHNlKSB7XG4gICAgICAgIGFkZEFubm90YXRpb24oYW5uUGFyYW0pO1xuICAgIH1cbn0pO1xuXG52YXIgZmlsZXNQYXJhbSA9IHtcbiAgICB0YWJsZTogJChcInRhYmxlI01SSUZpbGVzXCIpLFxuICAgIGluZm9fcHJveHk6IHByb2plY3RJbmZvUHJveHksXG4gICAgaW5mbzogcHJvamVjdEluZm8sXG4gICAgdHJUZW1wbGF0ZTogJC5tYXAoW1xuICAgICAgICBcIjx0cj5cIixcbiAgICAgICAgXCIgICAgPHRkIGNvbnRlbnRFZGl0YWJsZT10cnVlIGNsYXNzPSdub0VtcHR5Jz48L3RkPlwiLFxuICAgICAgICBcIiAgICA8dGQgY29udGVudEVkaXRhYmxlPXRydWUgY2xhc3M9J25vRW1wdHknPjwvdGQ+XCIsXG4gICAgICAgIFwiPC90cj5cIl0sZnVuY3Rpb24obyl7cmV0dXJuIG99KS5qb2luKFwiXCIpLFxuICAgIG9ialRlbXBsYXRlOiBbXG4gICAgICAgIHtcdHR5cGVPZkJpbmRpbmc6MixcbiAgICAgICAgICAgIHBhdGg6XCJmaWxlcy5saXN0LiMuc291cmNlXCJcbiAgICAgICAgfSxcbiAgICAgICAge1x0dHlwZU9mQmluZGluZzoyLFxuICAgICAgICAgICAgcGF0aDpcImZpbGVzLmxpc3QuIy5uYW1lXCJcbiAgICAgICAgfVxuICAgIF1cbn07XG5cbnZhciBjdXJzb3JGaWxlcyA9IDA7XG5xdWVyeUZpbGVzKCk7XG5cbmZ1bmN0aW9uIHF1ZXJ5RmlsZXMoKSB7XG4gICAgJC5nZXQoXCIvcHJvamVjdC9qc29uL1wiK3Byb2plY3RJbmZvLnNob3J0bmFtZStcIi9maWxlc1wiLCB7c3RhcnQ6Y3Vyc29yRmlsZXMsbGVuZ3RoOjEwMCxuYW1lOnRydWV9KVxuICAgIC50aGVuKGZ1bmN0aW9uKGxpc3QpIHtcbiAgICAgICAgaWYobGlzdC5sZW5ndGgpIHtcbiAgICAgICAgICAgIGFwcGVuZEZpbGVzKGxpc3QpO1xuICAgICAgICAgICAgY3Vyc29yRmlsZXMgKz0gMTAwO1xuICAgICAgICAgICAgcXVlcnlGaWxlcygpO1xuICAgICAgICB9XG4gICAgfSk7XG59XG5mdW5jdGlvbiBhcHBlbmRGaWxlcyhsaXN0KSB7XG4gICAgcHJvamVjdEluZm8uZmlsZXMubGlzdC5wdXNoLmFwcGx5KHByb2plY3RJbmZvLmZpbGVzLmxpc3QsIGxpc3QpO1xuICAgIGZvcih2YXIgaT0wO2k8bGlzdC5sZW5ndGg7aSsrKSB7XG4gICAgICAgIEJyYWluQm94LmFwcGVuZEFubm90YXRpb25UYWJsZVJvdyhjdXJzb3JGaWxlcyArIGksIGZpbGVzUGFyYW0pO1xuICAgIH1cbiAgICAkKFwiI251bUZpbGVzXCIpLnRleHQocHJvamVjdEluZm8uZmlsZXMubGlzdC5sZW5ndGgpO1xufVxuXG5cbiQoXCIjcHJvakRlc2NyaXB0aW9uICNudW1GaWxlc1wiKS50ZXh0KHByb2plY3RJbmZvLmZpbGVzLmxpc3QubGVuZ3RoKTtcbiQoXCIjcHJvakRlc2NyaXB0aW9uICNudW1Bbm5vdGF0aW9uc1wiKS50ZXh0KHByb2plY3RJbmZvLmFubm90YXRpb25zLmxpc3QubGVuZ3RoKTtcbiQoXCIjcHJvakRlc2NyaXB0aW9uICNudW1Db2xsYWJvcmF0b3JzXCIpLnRleHQocHJvamVjdEluZm8uY29sbGFib3JhdG9ycy5saXN0Lmxlbmd0aCk7XG5cbi8vIGZvciB0aGUgYWNjZXNzIHdpZGdldFxuJChcImJvZHlcIikub24oJ2NsaWNrJyxcIi52aWV3XCIsZnVuY3Rpb24oZSl7b25BY2Nlc3NDbGlja2VkKGUsMCl9KTtcbiQoXCJib2R5XCIpLm9uKCdjbGljaycsXCIuZWRpdFwiLGZ1bmN0aW9uKGUpe29uQWNjZXNzQ2xpY2tlZChlLDEpfSk7XG4kKFwiYm9keVwiKS5vbignY2xpY2snLFwiLmFkZFwiLGZ1bmN0aW9uKGUpe29uQWNjZXNzQ2xpY2tlZChlLDIpfSk7XG4kKFwiYm9keVwiKS5vbignY2xpY2snLFwiLnJlbW92ZVwiLGZ1bmN0aW9uKGUpe29uQWNjZXNzQ2xpY2tlZChlLDMpfSk7XG4kKFwiI2FjY2VzcyB0Ym9keVwiKS5vbignY2xpY2snLCd0cicsZnVuY3Rpb24oZSl7c2VsZWN0Um93KGUpO2Rpc2FibGVEZWxldGVPbkFueW9uZVVzZXIoZSk7fSk7XG5cbiQoXCIjYW5ub3RhdGlvbnMgdGJvZHlcIikub24oJ2NsaWNrJywndHInLHNlbGVjdFJvdyk7XG4kKFwiI01SSUZpbGVzIHRib2R5XCIpLm9uKCdjbGljaycsJ3RyJyxzZWxlY3RSb3cpO1xuXG4kKFwiI3NhdmVDaGFuZ2VzXCIpLmNsaWNrKHNhdmVDaGFuZ2VzKTtcbiQoXCIjZGVsZXRlUHJvamVjdFwiKS5jbGljayhkZWxldGVQcm9qZWN0KTtcbiQoXCIjZ29Ub1Byb2plY3RcIikuY2xpY2soZnVuY3Rpb24gZ29Ub1Byb2plY3QoKXtsb2NhdGlvbi5wYXRobmFtZT1gL3Byb2plY3QvJHtwcm9qZWN0U2hvcnRuYW1lfWB9KTtcblxuJChcImJvZHlcIikub24oJ2NsaWNrJyxcIi5kaXNwbGF5XCIsZnVuY3Rpb24oZSl7b25DaGVja0NsaWNrZWQoZSl9KTsgLy8gZm9yIHRoZSBkaXNwbGF5IG9wdGlvblxuXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCBcIiNhZGRDb2xsYWJvcmF0b3JcIiwgZnVuY3Rpb24oKXthZGRDb2xsYWJvcmF0b3IoYWNjUGFyYW0pfSk7XG4kKGRvY3VtZW50KS5vbignY2xpY2snLCBcIiNyZW1vdmVDb2xsYWJvcmF0b3JcIiwgZnVuY3Rpb24oKXtyZW1vdmVDb2xsYWJvcmF0b3IoYWNjUGFyYW0pfSk7XG4kKFwidGFibGUjYWNjZXNzIHRyXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4kKFwidGFibGUjYWNjZXNzIHRib2R5IHRyXCIpLmVxKDApLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XG4kKFwidGFibGUjYWNjZXNzIHRib2R5IHRyOmVxKDApIHRkXCIpLnJlbW92ZUF0dHIoXCJjb250ZW50RWRpdGFibGVcIik7XG4kKFwiI3JlbW92ZUNvbGxhYm9yYXRvclwiKS5hZGRDbGFzcyhcImRpc2FibGVkXCIpO1xuXG4kKGRvY3VtZW50KS5vbignY2xpY2snLCBcIiNhZGRBbm5vdGF0aW9uXCIsIGZ1bmN0aW9uKCl7YWRkQW5ub3RhdGlvbihhbm5QYXJhbSl9KTtcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsIFwiI3JlbW92ZUFubm90YXRpb25cIiwgZnVuY3Rpb24oKXtyZW1vdmVBbm5vdGF0aW9uKGFublBhcmFtKX0pO1xuJChcInRhYmxlI2Fubm90YXRpb25zIHRyXCIpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4kKFwidGFibGUjYW5ub3RhdGlvbnMgdGJvZHkgdHJcIikuZXEoMCkuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcblxuJChkb2N1bWVudCkub24oJ2NsaWNrJywgXCIjYWRkRmlsZVwiLCBmdW5jdGlvbigpe2FkZEZpbGUoZmlsZXNQYXJhbSl9KTtcbiQoZG9jdW1lbnQpLm9uKCdjbGljaycsIFwiI3JlbW92ZUZpbGVcIiwgZnVuY3Rpb24oKXtyZW1vdmVGaWxlKGZpbGVzUGFyYW0pfSk7XG4kKGRvY3VtZW50KS5vbignY2xpY2snLCBcIiNpbXBvcnRGaWxlc1wiLCBmdW5jdGlvbigpe2ltcG9ydEZpbGVzKCl9KTtcbiQoXCJ0YWJsZSNNUklGaWxlcyB0clwiKS5yZW1vdmVDbGFzcyhcInNlbGVjdGVkXCIpO1xuJChcInRhYmxlI01SSUZpbGVzIHRib2R5IHRyXCIpLmVxKDApLmFkZENsYXNzKFwic2VsZWN0ZWRcIik7XG5cbiQoXCIjaW1wb3J0RmlsZXNEaWFsb2dPa1wiKS5jbGljayhpbXBvcnRGaWxlc0RpYWxvZyk7XG4kKFwiI2ltcG9ydEZpbGVzRGlhbG9nQ2FuY2VsXCIpLmNsaWNrKGZ1bmN0aW9uKCkge1xuICAgICQoXCIjaW1wb3J0RmlsZXNEaWFsb2dcIikuaGlkZSgpO1xufSk7XG4kKFwiI2FkZFByb2plY3RcIikuY2xpY2soZnVuY3Rpb24oKXtsb2NhdGlvbj1cIi9wcm9qZWN0L25ld1wifSk7XG5cbi8vIGxpc3RlbiB0byB0eXBlIG9mIGFubm90YXRpb24gY2hhbmdlc1xuJChcIiNhbm5vdGF0aW9ucyB0Ym9keVwiKS5vbignY2hhbmdlJywgXCJ0ZDpudGgtY2hpbGQoMikgc2VsZWN0XCIsIGZ1bmN0aW9uKGUpIHtcbiAgICB2YXIgaXJvdz0kKGUudGFyZ2V0KS5jbG9zZXN0KFwidHJcIikuaW5kZXgoKTtcbiAgICB2YXIgdD0kKGUudGFyZ2V0KS5wcm9wKCdzZWxlY3RlZEluZGV4Jyk7XG4gICAgaWYodD09MCkge1xuICAgICAgICB2YXIgYXJyPSBbXG4gICAgICAgICAgICBcIjxzZWxlY3Q+XCIsXG4gICAgICAgICAgICBCcmFpbkJveC5sYWJlbFNldHMubWFwKGZ1bmN0aW9uKG8pe3JldHVybiBcIjxvcHRpb24+XCIrby5uYW1lK1wiPC9vcHRpb24+XCJ9KSxcbiAgICAgICAgICAgIFwiPC9zZWxlY3Q+XCJcbiAgICAgICAgXTtcbiAgICAgICAgdmFyIHN0cj0kLm1hcChhcnIsZnVuY3Rpb24obyl7cmV0dXJuIG99KS5qb2luKFwiXCIpO1xuICAgICAgICAkKFwiI2Fubm90YXRpb25zIHRib2R5ICB0cjplcShcIitpcm93K1wiKSB0ZDplcSgyKVwiKS5odG1sKHN0cik7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgJChcIiNhbm5vdGF0aW9ucyB0Ym9keSAgdHI6ZXEoXCIraXJvdytcIikgdGQ6ZXEoMilcIikuaHRtbChcIlwiKTtcbiAgICB9XG59KTtcblxuLyoqXG4gKiBAZnVuY3Rpb24gb25BY2Nlc3NDbGlja2VkXG4gKiBAZGVzYyBIYW5kbGVzIGNsaWNrIG9uIG9uZSBvZiB0aGUgNSBhY2Nlc3MgbGV2ZWxzOiAwPW5vbmUsIDE9dmlldywgMj1lZGl0LCAzPWFkZCwgND1yZW1vdmVcbiAqIEBwYXJhbSB7RXZlbnR9IGUgRXZlbnQgdHJpZ2dlcmVkIGJ5IHRoZSBjbGlja1xuICogQHBhcmFtIHtpbnR9IGwgQmFzZSBsZXZlbCBvZiB0aGUgYWNjZXNzIGljb24gY2xpY2tlZFxuICovXG5mdW5jdGlvbiBvbkFjY2Vzc0NsaWNrZWQoIGUsIGwgKSB7XG4gICAgLy8gYWNjZXNzIGxldmVsIFxuICAgIHZhciBhbCA9ICQoIGUudGFyZ2V0ICkuY2xvc2VzdCggXCJkaXZcIiApLmF0dHIoIFwiZGF0YS1sZXZlbFwiICk7XG4gICAgJCggZS50YXJnZXQgKS5jbG9zZXN0KCBcImRpdlwiICkuYXR0ciggXCJkYXRhLWxldmVsXCIsbCsoIGFsICE9IChsKzEpICkgKTtcbn1cblxuLyoqIFxuICogQGZ1bmN0aW9uIG9uQ2hlY2tDbGlja2VkXG4gKiBAZGVzYyBIYW5kbGVzIGNsaWNrIG9uICdkaXNwbGF5JyBvcHRpb24gZm9yIGFubm90YXRpb25zIGluIHRoZSBwcm9qZWN0IHNldHRpbmdzOyAwPWRvIG5vdCBkaXNwbGF5OyAxPWRpc3BsYXlcbiAqIEBwYXJhbSB7RXZlbnR9IGUgRXZlbnQgdHJpZ2dlcmVkIGJ5IGNsaWNrXG4gKi9cbmZ1bmN0aW9uIG9uQ2hlY2tDbGlja2VkKCBlLCBsICkge1xuICAgIC8vIGNoZWNrYm94IHRvZ2dsZSBmb3IgJ2Rpc3BsYXknIG9wdGlvblxuICAgIHZhciBjaGVja2JveCA9ICgkKCBlLnRhcmdldCApLmNsb3Nlc3QoXCJkaXZcIikuYXR0ciggXCJkYXRhLWNoZWNrXCIgKSA9PT0gXCIxXCIpO1xuICAgIGlmKCBjaGVja2JveCA9PSBmYWxzZSApIHtcbiAgICAgICAgJCggZS50YXJnZXQgKS5jbG9zZXN0KFwiZGl2XCIpLmF0dHIoIFwiZGF0YS1jaGVja1wiLCBcIjFcIiApO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgJCggZS50YXJnZXQgKS5jbG9zZXN0KFwiZGl2XCIpLmF0dHIoIFwiZGF0YS1jaGVja1wiLCBcIjBcIiApO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gc2VsZWN0Um93KGUpIHtcbiAgICAkKGUuY3VycmVudFRhcmdldCkuY2xvc2VzdChcInRib2R5XCIpLmZpbmQoXCJ0clwiKS5lYWNoKGZ1bmN0aW9uKGluZGV4LCB0YWcpIHtcbiAgICAgICAgJCh0YWcpLnJlbW92ZUNsYXNzKFwic2VsZWN0ZWRcIik7XG4gICAgfSlcbiAgICAkKGUuY3VycmVudFRhcmdldCkuYWRkQ2xhc3MoXCJzZWxlY3RlZFwiKTtcbn1cbmZ1bmN0aW9uIGRpc2FibGVEZWxldGVPbkFueW9uZVVzZXIoZSkge1xuICAgIHZhciBjdXJUYWJsZSA9ICQoZS5jdXJyZW50VGFyZ2V0KS5jbG9zZXN0KFwidGFibGVcIikuYXR0cihcImlkXCIpO1xuXG4gICAgLy8gY2hlY2sgaWYgdGhlIHNlbGVjdGVkIHJvdyBiZWxvbmdzIHRvIHRoZSAjYWNjZXNzIHRhYmxlXG4gICAgaWYoY3VyVGFibGUgPT09IFwiYWNjZXNzXCIpIHtcbiAgICAgICAgLy8gY2hlY2sgaWYgdGhlIHNlbGVjdGVkIHVzZXIgaXMgJ2FueW9uZSdcbiAgICAgICAgdmFyIHJvd0luZGV4ID0gJChlLmN1cnJlbnRUYXJnZXQpLmNsb3Nlc3QoXCJ0Ym9keVwiKS5maW5kKFwidHIuc2VsZWN0ZWRcIikuaW5kZXgoKTtcbiAgICAgICAgaWYocHJvamVjdEluZm8uY29sbGFib3JhdG9ycy5saXN0W3Jvd0luZGV4XS51c2VySUQgPT09ICdhbnlvbmUnKSB7XG4gICAgICAgICAgICAvLyBpZiB5ZXMsIGRpc2FibGUgdGhlICdyZW1vdmUnIGJ1dHRvblxuICAgICAgICAgICAgJChcIiNyZW1vdmVDb2xsYWJvcmF0b3JcIikuYWRkQ2xhc3MoJ2Rpc2FibGVkJyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKFwiI3JlbW92ZUNvbGxhYm9yYXRvclwiKS5yZW1vdmVDbGFzcygnZGlzYWJsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbn1cblxuZnVuY3Rpb24gaW1wb3J0RmlsZXNEaWFsb2coKSB7XG4gICAgdmFyIHN1bT0wO1xuICAgICQoXCIjaW1wb3J0RmlsZXNEaWFsb2cgdGJvZHkgdHJcIikuZWFjaChmdW5jdGlvbihpLG8pIHtcbiAgICAgICAgdmFyIHVybD0kKG8pLmZpbmQoXCJ0ZDplcSgwKVwiKS50ZXh0KCk7XG4gICAgICAgIHZhciBuYW1lPSQobykuZmluZChcInRkOmVxKDEpXCIpLnRleHQoKTtcbiAgICAgICAgdmFyIGksZm91bmQ7XG4gICAgICAgIFxuICAgICAgICBpZih1cmwubGVuZ3RoPDEwKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICBcbiAgICAgICAgLy8gdXBkYXRlIHRoZSBwcm9qZWN0SW5mbyBvYmplY3QgYnkgY2FsbGluZyB0aGUgcHJveHkncyBnZXR0ZXJzXG4gICAgICAgIEpTT04uc3RyaW5naWZ5KHByb2plY3RJbmZvUHJveHkpO1xuICAgICAgICBcbiAgICAgICAgLy8gbG9vayBpZiB0aGUgTVJJIGZpbGUgaXMgbm90IGFscmVhZHkgaW4gdGhlIGxpc3RcbiAgICAgICAgZm91bmQ9ZmFsc2U7XG4gICAgICAgIGZvcihpIGluIHByb2plY3RJbmZvLmZpbGVzLmxpc3QpIHtcbiAgICAgICAgICAgIGlmKHByb2plY3RJbmZvLmZpbGVzLmxpc3RbaV0uc291cmNlPT11cmwpIHtcbiAgICAgICAgICAgICAgICBpZihwcm9qZWN0SW5mby5maWxlcy5saXN0W2ldLm5hbWU9PVwiXCIpXG4gICAgICAgICAgICAgICAgICAgIHByb2plY3RJbmZvUHJveHlbXCJmaWxlcy5saXN0LlwiK2krXCIubmFtZVwiXT1uYW1lO1xuICAgICAgICAgICAgICAgIGZvdW5kPXRydWU7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYoZm91bmQ9PT1mYWxzZSkge1xuICAgICAgICAgICAgcHJvamVjdEluZm8uZmlsZXMubGlzdC5wdXNoKHtzb3VyY2U6dXJsLCBuYW1lOm5hbWV9KTtcblxuICAgICAgICAgICAgLy8gYWRkIGFuZCBiaW5kIG5ldyB0YWJsZSByb3dcbiAgICAgICAgICAgIHZhciBpPXByb2plY3RJbmZvLmZpbGVzLmxpc3QubGVuZ3RoLTE7XG4gICAgICAgICAgICBCcmFpbkJveC5hcHBlbmRBbm5vdGF0aW9uVGFibGVSb3coaSxmaWxlc1BhcmFtKTtcblxuICAgICAgICAgICAgJChcIiNwcm9qRGVzY3JpcHRpb24gI251bUZpbGVzXCIpLnRleHQocHJvamVjdEluZm8uZmlsZXMubGlzdC5sZW5ndGgpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBzdW0rKztcbiAgICAgICAgfVxuICAgIH0pO1xuICAgICQoXCIjaW1wb3J0RmlsZXNEaWFsb2dcIikuaGlkZSgpO1xuICAgIGNvbnNvbGUubG9nKHN1bSxcImZpbGVzIGFkZGVkXCIpO1xufVxuZnVuY3Rpb24gYWRkQ29sbGFib3JhdG9yKHBhcmFtKSB7XG4gICAgcHJvamVjdEluZm8uY29sbGFib3JhdG9ycy5saXN0LnB1c2goe1xuICAgICAgICB1c2VySUQ6IFwiXCIsXG4gICAgICAgIGFjY2Vzczoge1xuICAgICAgICAgICAgY29sbGFib3JhdG9yczpcInZpZXdcIixcbiAgICAgICAgICAgIGFubm90YXRpb25zOlwidmlld1wiLFxuICAgICAgICAgICAgZmlsZXM6XCJ2aWV3XCJcbiAgICAgICAgfVxuICAgIH0pO1xuXG4gICAgLy8gYWRkIGFuZCBiaW5kIG5ldyB0YWJsZSByb3dcbiAgICB2YXIgaT1wcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3QubGVuZ3RoLTE7XG4gICAgQnJhaW5Cb3guYXBwZW5kQW5ub3RhdGlvblRhYmxlUm93KGkscGFyYW0pO1xuICAgIFxuICAgIC8qKiBAdG9kbyBGaXg6IFRoaXMgaXMgYWRkaW5nIHRoZSBhdXRvY29tcGxldGlvbiBsaXN0ZW5lciBhZ2FpbiBhbmQgYWdhaW4gdG8gcHJldmlvdXNseVxuICAgICAqICAgICAgICBhZGRlZCBjb2xsYWJvcmF0b3JzXG4gICAgICovXG4gICAgLy8gY29uZmlndXJlIGF1dG9jb21wbGV0aW9uXG4gICAgJChcIi5hdXRvY29tcGxldGVcIikuYXV0b2NvbXBsZXRlKHtcbiAgICAgICAgbWluTGVuZ3RoOiAwLFxuICAgICAgICBzb3VyY2U6IGZ1bmN0aW9uKHJlcSxyZXMpIHtcbiAgICAgICAgICAgIHZhciBrZXkgPSAkKHRoaXMuZWxlbWVudCkuYXR0cignZGF0YS1hdXRvY29tcGxldGUnKTtcbiAgICAgICAgICAgIHN3aXRjaChrZXkpIHtcbiAgICAgICAgICAgICAgICBjYXNlIFwidXNlci5uaWNrbmFtZVwiOlxuICAgICAgICAgICAgICAgICAgICB3cy5zZW5kKEpTT04uc3RyaW5naWZ5KHtcInR5cGVcIjpcInVzZXJOYW1lUXVlcnlcIiwgXCJtZXRhZGF0YVwiOntcIm5pY2tuYW1lXCI6cmVxLnRlcm19fSkpO1xuICAgICAgICAgICAgICAgICAgICBsYWJlbD1cIm5pY2tuYW1lXCI7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgXCJ1c2VyLm5hbWVcIjpcbiAgICAgICAgICAgICAgICAgICAgd3Muc2VuZChKU09OLnN0cmluZ2lmeSh7XCJ0eXBlXCI6XCJ1c2VyTmFtZVF1ZXJ5XCIsIFwibWV0YWRhdGFcIjp7XCJuYW1lXCI6cmVxLnRlcm19fSkpO1xuICAgICAgICAgICAgICAgICAgICBsYWJlbD1cIm5hbWVcIjtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYj1yZXM7XG4gICAgICAgIH0sXG4gICAgICAgIHNlbGVjdDpmdW5jdGlvbihlLHVpKSB7XG4gICAgICAgICAgICB2YXIgaXJvdz0kKGUudGFyZ2V0KS5jbG9zZXN0KCd0cicpLmluZGV4KCk7XG4gICAgICAgICAgICBwcm9qZWN0SW5mb1Byb3h5W1wiY29sbGFib3JhdG9ycy5saXN0LlwiK2lyb3crXCIubmFtZVwiXT11aS5pdGVtLm5hbWU7XG4gICAgICAgICAgICBwcm9qZWN0SW5mb1Byb3h5W1wiY29sbGFib3JhdG9ycy5saXN0LlwiK2lyb3crXCIudXNlcklEXCJdPXVpLml0ZW0ubmlja25hbWU7XG5cbiAgICAgICAgICAgIC8vIGFkZCB1c2VyIHRvIGFjY2VzcyBvYmplY3RzXG4gICAgICAgICAgICBwcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3RbaXJvd10udXNlcklEPXVpLml0ZW0ubmlja25hbWU7XG4gICAgICAgIH1cbiAgICB9KTtcblxuICAgIC8vIHVwZGF0ZSBudW1iZXIgb2YgY29sbGFib3JhdG9ycyBjb3VudGVyXG4gICAgJChcIiNwcm9qRGVzY3JpcHRpb24gI251bUNvbGxhYm9yYXRvcnNcIikudGV4dChwcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3QubGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIHJlbW92ZUNvbGxhYm9yYXRvcihwYXJhbSkge1xuICAgIC8vIHJlbW92ZSByb3cgZnJvbSB0YWJsZVxuICAgIHZhciBpbmRleD0kKHBhcmFtLnRhYmxlKS5maW5kKFwidGJvZHkgLnNlbGVjdGVkXCIpLmluZGV4KCk7XG4gICAgJChwYXJhbS50YWJsZSkuZmluZCgndGJvZHkgdHI6ZXEoJytpbmRleCsnKScpLnJlbW92ZSgpO1xuICAgIFxuICAgIC8vIHJlbW92ZSBiaW5kaW5nXG4gICAgSlNPTi5zdHJpbmdpZnkocGFyYW0uaW5mb19wcm94eSk7IC8vIHVwZGF0ZSBwcm9qZWN0SW5mbyBmcm9tIHByb2plY3RJbmZvUHJveHlcbiAgICB2YXIgaXJvdz1wcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3QubGVuZ3RoLTE7XG4gICAgZm9yKHZhciBpY29sPTA7IGljb2w8cGFyYW0ub2JqVGVtcGxhdGUubGVuZ3RoOyBpY29sKyspIHtcbiAgICAgICAgdW5iaW5kMihwYXJhbS5pbmZvX3Byb3h5LHBhcmFtLm9ialRlbXBsYXRlW2ljb2xdLnBhdGgucmVwbGFjZShcIiNcIiwgaXJvdykpO1xuICAgIH1cbiAgICBcbiAgICAvLyByZW1vdmUgcm93IGZyb20gQnJhaW5Cb3guaW5mby5tcmkuYXRsYXNcbiAgICBwcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3Quc3BsaWNlKGluZGV4LDEpO1xuXG4gICAgJChcIiNwcm9qRGVzY3JpcHRpb24gI251bUNvbGxhYm9yYXRvcnNcIikudGV4dChwcm9qZWN0SW5mby5jb2xsYWJvcmF0b3JzLmxpc3QubGVuZ3RoKTtcbn1cbmZ1bmN0aW9uIGFkZEFubm90YXRpb24ocGFyYW0pIHtcbiAgICBwcm9qZWN0SW5mby5hbm5vdGF0aW9ucy5saXN0LnB1c2goe1xuICAgICAgICB0eXBlOlwidm9sdW1lXCIsXG4gICAgICAgIHZhbHVlczpCcmFpbkJveC5sYWJlbFNldHNbMF0uc291cmNlLFxuICAgICAgICBkaXNwbGF5OlwidHJ1ZVwiXG4gICAgfSk7XG5cbiAgICAvLyBhZGQgYW5kIGJpbmQgbmV3IHRhYmxlIHJvd1xuICAgIHZhciBpPXByb2plY3RJbmZvLmFubm90YXRpb25zLmxpc3QubGVuZ3RoLTE7XG4gICAgQnJhaW5Cb3guYXBwZW5kQW5ub3RhdGlvblRhYmxlUm93KGkscGFyYW0pO1xuXG4gICAgJChcIiNwcm9qRGVzY3JpcHRpb24gI251bUFubm90YXRpb25zXCIpLnRleHQocHJvamVjdEluZm8uYW5ub3RhdGlvbnMubGlzdC5sZW5ndGgpO1xufVxuZnVuY3Rpb24gcmVtb3ZlQW5ub3RhdGlvbihwYXJhbSkge1xuICAgIC8vIHJlbW92ZSByb3cgZnJvbSB0YWJsZVxuICAgIHZhciBpbmRleD0kKHBhcmFtLnRhYmxlKS5maW5kKFwidGJvZHkgLnNlbGVjdGVkXCIpLmluZGV4KCk7XG4gICAgJChwYXJhbS50YWJsZSkuZmluZCgndGJvZHkgdHI6ZXEoJytpbmRleCsnKScpLnJlbW92ZSgpO1xuICAgIFxuICAgIC8vIHJlbW92ZSBiaW5kaW5nXG4gICAgSlNPTi5zdHJpbmdpZnkocGFyYW0uaW5mb19wcm94eSk7IC8vIHVwZGF0ZSBwcm9qZWN0SW5mbyBmcm9tIHByb2plY3RJbmZvUHJveHlcbiAgICB2YXIgaXJvdz1wcm9qZWN0SW5mby5hbm5vdGF0aW9ucy5saXN0Lmxlbmd0aC0xO1xuICAgIGZvcih2YXIgaWNvbD0wOyBpY29sPHBhcmFtLm9ialRlbXBsYXRlLmxlbmd0aDsgaWNvbCsrKSB7XG4gICAgICAgIHVuYmluZDIocGFyYW0uaW5mb19wcm94eSxwYXJhbS5vYmpUZW1wbGF0ZVtpY29sXS5wYXRoLnJlcGxhY2UoXCIjXCIsIGlyb3cpKTtcbiAgICB9XG4gICAgXG4gICAgLy8gcmVtb3ZlIHJvdyBmcm9tIEJyYWluQm94LmluZm8ubXJpLmF0bGFzXG4gICAgcHJvamVjdEluZm8uYW5ub3RhdGlvbnMubGlzdC5zcGxpY2UoaW5kZXgsMSk7XG5cbiAgICAkKFwiI3Byb2pEZXNjcmlwdGlvbiAjbnVtQW5ub3RhdGlvbnNcIikudGV4dChwcm9qZWN0SW5mby5hbm5vdGF0aW9ucy5saXN0Lmxlbmd0aCk7XG59XG5mdW5jdGlvbiBhZGRGaWxlKHBhcmFtKSB7XG4gICAgcHJvamVjdEluZm8uZmlsZXMubGlzdC5wdXNoKHt9KTtcblxuICAgIC8vIGFkZCBhbmQgYmluZCBuZXcgdGFibGUgcm93XG4gICAgdmFyIGk9cHJvamVjdEluZm8uZmlsZXMubGlzdC5sZW5ndGgtMTtcbiAgICBCcmFpbkJveC5hcHBlbmRBbm5vdGF0aW9uVGFibGVSb3coaSxwYXJhbSk7XG5cbiAgICAkKFwiI3Byb2pEZXNjcmlwdGlvbiAjbnVtRmlsZXNcIikudGV4dChwcm9qZWN0SW5mby5maWxlcy5saXN0Lmxlbmd0aCk7XG59XG5mdW5jdGlvbiByZW1vdmVGaWxlKHBhcmFtKSB7XG4gICAgLy8gcmVtb3ZlIHJvdyBmcm9tIHRhYmxlXG4gICAgdmFyIGluZGV4PSQocGFyYW0udGFibGUpLmZpbmQoXCJ0Ym9keSAuc2VsZWN0ZWRcIikuaW5kZXgoKTtcbiAgICAkKHBhcmFtLnRhYmxlKS5maW5kKCd0Ym9keSB0cjplcSgnK2luZGV4KycpJykucmVtb3ZlKCk7XG4gICAgXG4gICAgLy8gcmVtb3ZlIGJpbmRpbmdcbiAgICBKU09OLnN0cmluZ2lmeShwYXJhbS5pbmZvX3Byb3h5KTsgLy8gdXBkYXRlIHByb2plY3RJbmZvIGZyb20gcHJvamVjdEluZm9Qcm94eVxuICAgIHZhciBpcm93PXByb2plY3RJbmZvLmZpbGVzLmxpc3QubGVuZ3RoLTE7XG4gICAgZm9yKHZhciBpY29sPTA7IGljb2w8cGFyYW0ub2JqVGVtcGxhdGUubGVuZ3RoOyBpY29sKyspIHtcbiAgICAgICAgdW5iaW5kMihwYXJhbS5pbmZvX3Byb3h5LHBhcmFtLm9ialRlbXBsYXRlW2ljb2xdLnBhdGgucmVwbGFjZShcIiNcIiwgaXJvdykpO1xuICAgIH1cbiAgICBcbiAgICAvLyByZW1vdmUgcm93IGZyb20gQnJhaW5Cb3guaW5mby5tcmkuYXRsYXNcbiAgICBwcm9qZWN0SW5mby5maWxlcy5saXN0LnNwbGljZShpbmRleCwxKTtcblxuICAgICQoXCIjcHJvakRlc2NyaXB0aW9uICNudW1GaWxlc1wiKS50ZXh0KHByb2plY3RJbmZvLmZpbGVzLmxpc3QubGVuZ3RoKTtcbiAgICBcbiAgICAvLyBzZWxlY3QgdGhlIGNsb3Nlc3QgcmVtYWluaW5nIGNvbHVtblxuICAgICQocGFyYW0udGFibGUpLmZpbmQoJ3Rib2R5IHRyOmVxKCcrKE1hdGgubWluKGluZGV4LHByb2plY3RJbmZvLmZpbGVzLmxpc3QubGVuZ3RoLTEpKSsnKScpLmFkZENsYXNzKCdzZWxlY3RlZCcpO1xufVxuZnVuY3Rpb24gaW1wb3J0RmlsZXMoKSB7XG4gICAgLy8gdmFyIGlucHV0PWRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiaS1vcGVuLW1lc2hcIik7XG4gICAgY29uc29sZS5sb2coXCJpbXBvcnRpbmcgZmlsZXMuLi5cIik7XG4gICAgJChcImJvZHlcIikuYXBwZW5kKFwiPGlucHV0IGlkPSdpbXBvcnRGaWxlc0lucHV0JyBzdHlsZT0nZGlzcGxheTpub25lJz5cIik7XG4gICAgdmFyIGlucHV0PSQoXCIjaW1wb3J0RmlsZXNJbnB1dFwiKVswXTtcbiAgICBjb25zb2xlLmxvZyhpbnB1dCk7XG4gICAgaW5wdXQudHlwZT1cImZpbGVcIjtcbiAgICBpbnB1dC5vbmNoYW5nZT1mdW5jdGlvbihlKXtcbiAgICAgICAgdmFyIGZpbGU9dGhpcy5maWxlc1swXTtcbiAgICAgICAgdmFyIHJlYWRlciA9IG5ldyBGaWxlUmVhZGVyKCk7XG4gICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAkKFwiI2ltcG9ydEZpbGVzSW5wdXRcIikucmVtb3ZlKCk7XG4gICAgICAgICAgICAkKFwiI2ltcG9ydEZpbGVzRGlhbG9nXCIpLnNob3coKTtcbiAgICAgICAgICAgIHZhciByZXN1bHQ9ZS50YXJnZXQucmVzdWx0O1xuICAgICAgICAgICAgdmFyIGxpbmVzPXJlc3VsdC5zcGxpdChcIlxcblwiKTtcbiAgICAgICAgICAgIHZhciBodG1sPVtdOyAgICAgICAgICAgXG4gICAgICAgICAgICBmb3IoaSBpbiBsaW5lcykge1xuICAgICAgICAgICAgICAgIGNvbHM9bGluZXNbaV0uc3BsaXQoL1sgXSosWyBdKi8pO1xuICAgICAgICAgICAgICAgIGh0bWwucHVzaChcIjx0cj48dGQgY29udGVudEVkaXRhYmxlPSd0cnVlJz5cIitjb2xzWzBdK1wiPC90ZD48dGQ+XCIrY29sc1sxXStcIjwvdGQ+PC90cj5cIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICAkKFwiI2ltcG9ydEZpbGVzRGlhbG9nIHRib2R5XCIpLmFwcGVuZChodG1sLmpvaW4oXCJcXG5cIikpO1xuICAgICAgICB9XG4gICAgICAgIHJlYWRlci5yZWFkQXNUZXh0KGZpbGUpO1xuICAgIH1cbiAgICBpbnB1dC5jbGljaygpO1xufVxuZnVuY3Rpb24gc2F2ZUNoYW5nZXMoKSB7XG4gICAgLy8gdXBkYXRlIHByb2plY3RJbmZvIGZyb20gcHJvamVjdEluZm9Qcm94eVxuICAgIEpTT04uc3RyaW5naWZ5KHByb2plY3RJbmZvUHJveHkpO1xuXG4gICAgJC5wb3N0KFwiL3Byb2plY3QvanNvbi9cIitwcm9qZWN0SW5mby5zaG9ydG5hbWUsIHtcbiAgICAgICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkocHJvamVjdEluZm8pXG4gICAgfSkuZG9uZShmdW5jdGlvbihhLCBiKSB7XG4gICAgICAgIGlmKGEuc3VjY2Vzcykge1xuICAgICAgICAgICAgJChcIiNzYXZlRmVlZGJhY2tcIikudGV4dChcIlN1Y2Nlc3NmdWxseSBzYXZlZFwiKTtcbiAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgJChcIiNzYXZlRmVlZGJhY2tcIikudGV4dChcIlwiKTtcbiAgICAgICAgICAgIH0sMjAwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkKFwiI3NhdmVGZWVkYmFja1wiKS50ZXh0KFwiVW5hYmxlIHRvIHNhdmUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXJcIik7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQoXCIjc2F2ZUZlZWRiYWNrXCIpLnRleHQoXCJcIik7XG4gICAgICAgICAgICB9LDMwMDApO1xuICAgICAgICB9XG4gICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyKSB7XG4gICAgICAgICQoXCIjc2F2ZUZlZWRiYWNrXCIpLnRleHQoXCJVbmFibGUgdG8gc2F2ZS4gUGxlYXNlIHRyeSBhZ2FpbiBsYXRlciAoXCIrSlNPTi5zdHJpbmdpZnkoZXJyLnJlc3BvbnNlSlNPTi5tZXNzYWdlKStcIilcIik7XG4gICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAkKFwiI3NhdmVGZWVkYmFja1wiKS50ZXh0KFwiXCIpO1xuICAgICAgICB9LDMwMDApO1xuICAgICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIH0pO1xufVxuZnVuY3Rpb24gZGVsZXRlUHJvamVjdCgpIHtcbiAgICAvLyB1cGRhdGUgcHJvamVjdEluZm8gZnJvbSBwcm9qZWN0SW5mb1Byb3h5XG4gICAgSlNPTi5zdHJpbmdpZnkocHJvamVjdEluZm9Qcm94eSk7XG5cbiAgICB2YXIgcmVzID0gY29uZmlybShcbiAgICAgICAgXCJBcmUgeW91IHN1cmUgeW91IHdhbnQgdG8gZGVsZXRlIHByb2plY3QgXCJcbiAgICAgICAgKyBwcm9qZWN0SW5mby5zaG9ydG5hbWUrXCI/IFwiXG4gICAgICAgICsgXCJUaGlzIG9wZXJhdGlvbiBjYW5ub3QgYmUgdW5kb25lLlwiXG4gICAgKTtcbiAgICBcbiAgICBpZiAocmVzICE9PSB0cnVlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgXG4gICAgJC5hamF4KHtcbiAgICAgICAgdXJsOiBcIi9wcm9qZWN0L2pzb24vXCIrcHJvamVjdEluZm8uc2hvcnRuYW1lLFxuICAgICAgICBtZXRob2Q6IFwiZGVsZXRlXCIsXG4gICAgICAgIGRhdGE6SlNPTi5zdHJpbmdpZnkocHJvamVjdEluZm8pXG4gICAgfSkuZG9uZShmdW5jdGlvbihyZXNwb25zZSkge1xuICAgICAgICBpZihyZXNwb25zZS5zdWNjZXNzKSB7XG4gICAgICAgICAgICAkKFwiI3NhdmVGZWVkYmFja1wiKS50ZXh0KFwiU3VjY2Vzc2Z1bGx5IGRlbGV0ZWRcIik7XG4gICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICQoXCIjc2F2ZUZlZWRiYWNrXCIpLnRleHQoXCJcIik7XG4gICAgICAgICAgICAgICAgbG9jYXRpb249XCIvXCI7XG4gICAgICAgICAgICB9LDIwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgJChcIiNzYXZlRmVlZGJhY2tcIikudGV4dChcIlVuYWJsZSB0byBkZWxldGUgKFwiK3Jlc3BvbnNlLm1lc3NhZ2UrXCIpXCIpO1xuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAkKFwiI3NhdmVGZWVkYmFja1wiKS50ZXh0KFwiXCIpO1xuICAgICAgICAgICAgfSwzMDAwKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZS5tZXNzYWdlKTtcbiAgICB9KS5jYXRjaChmdW5jdGlvbihlcnIpIHtcbiAgICAgICAgJChcIiNzYXZlRmVlZGJhY2tcIikudGV4dChcIlVuYWJsZSB0byBkZWxldGUuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIgKFwiK0pTT04uc3RyaW5naWZ5KGVyci5yZXNwb25zZUpTT04uZXJyb3IuZXJyb3IpK1wiKVwiKTtcbiAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICQoXCIjc2F2ZUZlZWRiYWNrXCIpLnRleHQoXCJcIik7XG4gICAgICAgIH0sMzAwMCk7XG4gICAgICAgIGNvbnNvbGUubG9nKGVycik7XG4gICAgfSk7XG59XG4iXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///8\n')}});